/*This input file defines the full MHTGR350 geometry.*/

/* Numbering:
* Universes: 1 to 10
* Surfaces: 100 to 200
* Cells: 500 to 600
*/

/******************************
*      Particle Definition    *
* Kernel radius 212.5e-6 m    *
* Buffer radius 312.5e-6 m    *
* IPyC radius   347.5e-6 m    *
* SiC radius    382.5e-6 m    *
* OPyC radius   422.5e-6 m    *
* Matrix Graphite             *
*******************************/
% -- Coated Particle
particle 1

uco    0.02125
buffer 0.03125
pyc    0.03475
sic    0.03825
pyc    0.04225
matrix

/*************************
*   Compact Definition   *
* Radius 0.6223 cm       *
* Length 4.928 cm        *  
* Packing Fraction 0.35  *
**************************/

surf 100 inf
cell 500 2 matrix -100
pbed 3 2 "particles79.inp"

% -- Fuel Channel
surf 101 cyl 0.0 0.0 0.6223 0.0 79.3
surf 102 cyl 0.0 0.0 0.635  0.0 79.3

cell 501 4 fill 3  -101
cell 502 4 helium   101 -102
cell 503 4 block    102

% -- Small Coolant Channel
surf 121 inf
cell 530 21 helium -121

surf 103 cyl 0.0 0.0 0.635 0.0 79.3

cell 504 5 fill 21 -103
cell 505 5 block    103

% -- Large Coolant Channel
surf 104 cyl 0.0 0.0 0.794 0.0 79.3

cell 506 6 fill 21 -104
cell 507 6 block    104

% -- Standard Fuel lattice
surf 105 inf
cell 508 7 block -105

lat 8 2 0.0 0.65 24 24 1.879
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
 7 7 7 7 7 7 7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 7
  7 7 7 7 7 7 7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 7
   7 7 7 7 7 7 7 7 7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 7
    7 7 7 7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7
     7 7 7 7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7
      7 7 7 7 7 7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 7
       7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7
        7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7
         7 7 7 7 6 4 4 6 4 4 6 4 4 5 4 4 6 4 4 6 4 4 6 7
          7 7 7 4 4 6 4 4 6 4 4 5 7 7 5 4 4 6 4 4 6 4 4 7
           7 7 4 6 4 4 6 4 4 6 4 7 7 7 4 6 4 4 6 4 4 6 4 7
            7 7 4 4 6 4 4 6 4 4 5 7 7 5 4 4 6 4 4 6 4 4 7 7
             7 7 6 4 4 6 4 4 6 4 4 5 4 4 6 4 4 6 4 4 6 7 7 7
              7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7 7 7 7
               7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7 7 7 7 7
                7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 7 7 7 7 7 7
                 7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7 7 7 7 7 7 7
                  7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7 7 7 7 7 7 7 7
                   7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 7 7 7 7 7 7 7 7 7
                    7 7 4 6 4 4 6 4 4 6 4 4 6 4 7 7 7 7 7 7 7 7 7 7
                     7 7 4 4 6 4 4 6 4 4 6 4 4 7 7 7 7 7 7 7 7 7 7 7
                      7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
                       7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7

% -- Standard Fuel Element Definition
surf 106 cyl 0.0 0.0 1.75 52.9 79.3
surf 107 hexyprism 0.0 0.0 18.0 0.0 79.3

cell 509 9 helium   -106
cell 510 9 fill 8    106 -107
cell 511 9 block     107

% -- RSC Fuel lattice
lat 10 2 0.0 0.65 24 24 1.879
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
 7 7 7 7 7 7 7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 7
  7 7 7 7 7 7 7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 7
   7 7 7 7 7 7 7 7 7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 7
    7 7 7 7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7
     7 7 7 7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7
      7 7 7 7 7 7 7 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 7
       7 7 7 7 7 7 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 7
        7 7 7 7 7 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 4 6 4 7
         7 7 7 7 6 4 4 6 4 4 6 4 4 5 4 4 6 4 4 6 4 4 6 7
          7 7 7 4 4 6 4 4 6 4 4 5 7 7 5 4 4 6 4 4 6 4 4 7
           7 7 4 6 4 4 6 4 4 6 4 7 7 7 4 6 4 4 6 4 4 6 4 7
            7 7 4 4 6 4 4 6 4 4 5 7 7 5 4 4 6 4 4 6 4 4 7 7
             7 7 6 4 4 6 4 4 6 4 4 5 4 4 6 4 4 6 4 4 6 7 7 7
              7 7 4 6 4 4 6 4 4 7 7 7 7 4 4 6 4 4 6 4 7 7 7 7
               7 7 4 4 6 4 4 6 7 7 7 7 7 6 4 4 6 4 4 7 7 7 7 7
                7 7 6 4 4 6 4 7 7 7 7 7 7 4 6 4 4 6 7 7 7 7 7 7
                 7 7 4 6 4 4 7 7 7 7 7 7 7 4 4 6 4 7 7 7 7 7 7 7
                  7 7 4 4 6 4 7 7 7 7 7 7 4 6 4 4 7 7 7 7 7 7 7 7
                   7 7 6 4 4 6 7 7 7 7 7 6 4 4 6 7 7 7 7 7 7 7 7 7
                    7 7 4 6 4 4 7 7 7 7 4 4 6 4 7 7 7 7 7 7 7 7 7 7
                     7 7 4 4 6 4 4 5 4 4 6 4 4 7 7 7 7 7 7 7 7 7 7 7
                      7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
                       7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7

% -- RSC Fuel Element Definition
surf 108 cyl 0.0 0.0 1.75 52.9 79.3
surf 109 cyl 0.0 9.756 4.762 0.0 79.3
surf 110 hexyprism 0.0 0.0 18.0 0.0 79.3

cell 512 11 helium   -108
cell 513 11 helium   -109
cell 514 11 fill 10   108 109 -110
cell 515 11 block     110

% -- Core Lattice
lat 13 3 -18.0 -18.0 20 20 36.0
7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
  7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
   7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
    7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
     7 7 7 7 7 7 7 7 7 7 7 8 8 8 8 7 7 7 7 7
      7 7 7 7 7 7 7 7 7 8 8 8 8 8 8 8 7 7 7 7
       7 7 7 7 7 7 7 7 8 8 8 8 8 8 8 8 7 7 7 7
        7 7 7 7 7 7 7 8 8 8 7 7 7 8 8 8 7 7 7 7
         7 7 7 7 7 7 8 8 8 7 7 7 7 8 8 8 7 7 7 7
          7 7 7 7 7 7 8 8 7 7 7 7 7 8 8 7 7 7 7 7
           7 7 7 7 7 8 8 8 7 7 7 7 8 8 8 7 7 7 7 7
            7 7 7 7 7 8 8 8 7 7 7 8 8 8 7 7 7 7 7 7
             7 7 7 7 7 8 8 8 8 8 8 8 8 7 7 7 7 7 7 7
              7 7 7 7 7 8 8 8 8 8 8 8 7 7 7 7 7 7 7 7
               7 7 7 7 7 7 8 8 8 8 7 7 7 7 7 7 7 7 7 7
                7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
                 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
                  7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7
                   7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7

surf 112 cyl 0.0 0.0 290 0.0 79.3

cell 517 14 fill 13   -112
cell 518 14 block      112

% -- Core Lattice Stack
lat 15 9 0.0 0.0 10
   0.0 14  79.3 14 158.6 14 237.9 14 317.2 14
 396.5 14 475.8 14 555.1 14 634.4 14 713.7 14

surf 113 cyl 0.0 0.0 340    0 793
surf 114 cyl 0.0 0.0 340 -160   0
surf 115 cyl 0.0 0.0 340  793 913
surf 116 cyl 0.0 0.0 340 -160 913

cell 519 0 fill 15  -113
cell 520 0 block    -114
cell 521 0 block    -115
cell 522 0 outside   116

/**********************************
*            Materials            *
* Kernel UCO Density (d) 10.5g/cc *
* - U (e% = 15.5%) 1              *
* - C 0.5                         *
* - O 1.5                         *
* Buffer d 1.0g/cc                *
* - C 100%                        *
* PyC d 1.9g/cc                   *
* - C 100%                        *
* SiC d 3.18g/cc                  *
* - Si 70.05%                     *
* - C  29.96%                     * 
* Matrix Graphite                 *
**********************************/

% UCO
mat uco      -10.5        tmp 750                 rgb 255 255 0
 92235.06c   -0.1376
 92238.06c   -0.7504
  6000.06c   -0.0224
  8016.06c   -0.0896

mat buffer   -1.0         tmp 750 moder grph 6000 rgb 255 128   0
 6000.06c    -1.0000

mat pyc      -1.9         tmp 750 moder grph 6000 rgb 255   0   0
 6000.06c    -1.0000

mat sic      -3.2         tmp 750 moder grph 6000 rgb 153  76   0
14000.06c    -0.7005
 6000.06c    -0.2996

mat matrix   -1.75        tmp 750 moder grph 6000 rgb 160 160 160
 6000.06c    -1.0000

mat block    -1.75        tmp 750 moder grph 6000 rgb 102 255 102
 6000.06c    -1.0000

mat helium   2.65156E-05  tmp 750                 rgb 150 105 255
 2004.06c    2.65156E-05

% --- Thermal scattering data for graphite:
therm grph 750 gre7.16t gre7.18t

% --- Cross section data library file path:
set acelib "/home/roberto/Serpent2/xs/sss_jeff311u"

% --- Periodic boundary condition:
set bc 1

% --- Neutron population and criticality cycles:
set pop 20000 400 100
%set opti 3

set usym 13 3 2 0.0 0.0 270 30

% --- Geometry plot:
plot 3 1000 1000
plot 1 1000 1000 0.0 0.0 216.0 -165.0 920.0

mesh 3 1000 1000

% --- Detector:
% det RadialFission dr -6 void du 3 dn 1 0.0 290 20 0 360 1 0 793 10
% How to choose the material if the compact doesn't have a material but a universe

% --- Detector for tallying the flux energy spectrum
det EnergyDetector de MyEnergyGrid
ene MyEnergyGrid 3 500 1e-11 2e1

% --- Cross sections generation (2G):
% 3: compact (or 4?)
% 21: helium (Large coolant channels)
% 7: moderator
set gcu 3 7 21
set nfg 2 0.625E-6

%set nfg 26 1.0E-8 2.0E-8 5.0E-8 8.0E-8 1.2E-7 2.0E-7 3.5E-7 6.5E-7 1.29E-6 2.38E-6 5.04E-6 8.32E-6 1.37E-5 2.9E-5 6.144E-5 1.301E-4 2.754E-4 7.485E-4 1.585E-3 3.355E-3 1.93E-2 1.11E-1 6.72E-1 3.68 7.41

branch fuel0
stp uco       -10.5       750
stp buffer     -1.0       750 grph gre7.16t gre7.18t
stp pyc        -1.9       750 grph gre7.16t gre7.18t
stp sic        -3.2       750 grph gre7.16t gre7.18t
stp matrix     -1.75      750 grph gre7.16t gre7.18t
stp block      -1.75      750 grph gre7.16t gre7.18t
stp helium    2.65156E-05 750

coef 1
0
1 fuel0