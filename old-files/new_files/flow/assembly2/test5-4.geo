// Defines a 3D 4 cooling channels
SetFactory("OpenCASCADE");

Rc = 0.794;
// Rc = 1.0;

p = 1.88;
f = p/Cos(Pi/6);

// Circles
c = 1;
X = 3/4*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+2*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+3*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+4*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+5*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+6*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

X = (3/4+7*3/2)*p;
x = X; y = -7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = -f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 3*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 5*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;
x = X; y = 7*f;
Circle(c) = { x, y, 0, Rc, 0, 2*Pi};
Curve Loop(c) = {c};
Plane Surface(c) = {c}; c+=1;

Extrude {0, 0, 5} {
   Surface{1}; Surface{2}; Surface{3}; Surface{4}; Surface{5};
   Surface{6}; Surface{7}; Surface{8}; Surface{9}; Surface{10};
   Surface{11}; Surface{12}; Surface{13}; Surface{14}; Surface{15};
   Surface{16}; Surface{17}; Surface{18}; Surface{19}; Surface{20};
   Surface{21}; Surface{22}; Surface{23}; Surface{24}; Surface{25};
   Surface{26}; Surface{27}; Surface{28}; Surface{29}; Surface{30};
   Surface{31}; Surface{32}; Surface{33}; Surface{34}; Surface{35};
   Surface{36}; Surface{37}; Surface{38}; Surface{39}; Surface{40};
   Surface{41}; Surface{42}; Surface{43}; Surface{44}; Surface{45};
   Surface{46}; Surface{47}; Surface{48}; Surface{49}; Surface{50};
   Surface{51}; Surface{52}; Surface{53}; Surface{54}; Surface{55};
   Surface{56}; Surface{57}; Surface{58}; Surface{59}; Surface{60};
   Surface{61}; Surface{62}; Surface{63}; Surface{64};
   Layers{20};
}

// pl = 125;
// Point(pl) = {0, -8*f, 5, 1.0}; pl+=1;
// Point(pl) = {0, 8*f, 5, 1.0}; pl+=1;
// Point(pl) = {12*p, -8*f, 5, 1.0}; pl+=1;
// Point(pl) = {12*p, 8*f, 5, 1.0}; pl+=1;



// Curve Loop(28) = {29, 30, 31, 32};
// Curve Loop(29) = {11};
// Curve Loop(30) = {13};
// Curve Loop(31) = {15};
// Curve Loop(32) = {17};
// Curve Loop(33) = {19};
// Curve Loop(34) = {21};
// Curve Loop(35) = {23};
// Curve Loop(36) = {25};
// Curve Loop(37) = {27};
// Plane Surface(28) = {28, 29, 30, 31, 32, 33, 34, 35, 36, 37};

// Extrude {0, 0, 1} {
//   Surface{11}; Surface{13}; Surface{15}; Surface{17}; Surface{19};
//   Surface{21}; Surface{23}; Surface{25}; Surface{27}; Surface{28}; 
//   Layers{20};
// }

// Physical Volume("coolant") = {
// 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
// 11, 12, 13, 14, 15, 16, 17, 18, 19
// };
// Physical Surface("channel_wall") = {
// 10, 12, 14, 16, 18, 20, 22, 24, 26
// };
// Physical Surface('plenum wall') = {50, 49, 48, 47};
// Physical Surface('plenum') = {28};
// Physical Surface("cool_bot") = {
// 	1, 2, 3, 4, 5, 6, 7, 8, 9
// };
// Physical Surface("cool_top") = {30, 32, 34, 36, 38, 40, 42, 44, 46, 51};

// Mesh.CharacteristicLengthFactor = 1;
// Mesh.CharacteristicLengthExtendFromBoundary = 1;
// Mesh.CharacteristicLengthFromCurvature = 1;
// Mesh.MinimumCirclePoints = 10;
